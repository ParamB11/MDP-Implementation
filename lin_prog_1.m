clear; clc;
aone = ones(2,2);
atwo = ones(2,1);
%% Problem Data
a=2;
d=0.5;
beta = [1; 1; 1; 1];
c0 = [10 1 2; 2 1 10]; %[c0(18,-2) c0(18,0) c0(18,2);c0(20,-2) c0(20,0) c0(20,2)]
c1 = [5 -1 2; 5 2 -1; -1 2 5; 2 -1 5]; %[c1(C,18,-2) c1(C,18,0) c1(C,18,2);c1(H,18,-2) c1(H,18,0) c1(H,18,2); c1(C,20,-2) c1(C,20,0) c1(C,20,2); c1(H,20,-2) c1(H,20,0) c1(H,20,2)]
p11 = [0.6 0.4; 0.2 0.8]; %[P(C|C,18) P(H|C,18); P(C|H,18) P(H|H,18)]
p12 = [0.8 0.2; 0.4 0.6]; %[P(C|C,20) P(H|C,20); P(C|H,20) P(H|H,20)]
p01 = [1 0.8 0.2; 0 0.2 0.8]; %[P(18|18,-2) P(18|18,0) P(18|18,2); P(20|18,-2) P(20|18,0) P(20|18,2)]
p02 = [0.8 0.2 0; 0.2 0.8 1]; %[P(18|20,-2) P(18|20,0) P(18|20,2); P(20|20,-2) P(20|20,0) P(20|20,2)]

%% Linear Program
s = zeros(4,1);
P_agent = [p11 p11; p12 p12];
P_state = zeros(4,4,3);
A0 = zeros(4,4,3);
A = zeros(12,4);
c = zeros(4,3);
b = zeros(12,1);
for i=1:3
    P_state(:,:,i) = [p01(1,i)*aone p01(2,i)*aone; p02(1,i)*aone p02(2,i)*aone];
    A0(:,:,i) = P_agent.*P_state(:,:,i);
    A((4*(i-1)+1):4*(i),:) = A0(:,:,i);
    c(:,i) = a*[c0(1,i)*atwo; c0(2,i)*atwo] + c1(:,i);
    b((4*(i-1)+1):4*i) = -c(:,i);
end
s = linprog(beta,-A,-b);